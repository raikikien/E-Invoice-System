<!DOCTYPE html>
<html lang="en">

<head>
    <title>Bootstrap Example</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.24/js/dataTables.bootstrap4.min.js"></script>

</head>

<body>

    <nav class="navbar navbar-expand-md navbar-light bg-light">
        <a class="navbar-brand" class="btn btn-outline-secondary" href="/user_table.html">
            <h2>
                <div class="fs-2 mb-3">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                        class="bi bi-receipt" viewBox="0 0 16 16">
                        <path
                            d="M1.92.506a.5.5 0 0 1 .434.14L3 1.293l.646-.647a.5.5 0 0 1 .708 0L5 1.293l.646-.647a.5.5 0 0 1 .708 0L7 1.293l.646-.647a.5.5 0 0 1 .708 0L9 1.293l.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .801.13l.5 1A.5.5 0 0 1 15 2v12a.5.5 0 0 1-.053.224l-.5 1a.5.5 0 0 1-.8.13L13 14.707l-.646.647a.5.5 0 0 1-.708 0L11 14.707l-.646.647a.5.5 0 0 1-.708 0L9 14.707l-.646.647a.5.5 0 0 1-.708 0L7 14.707l-.646.647a.5.5 0 0 1-.708 0L5 14.707l-.646.647a.5.5 0 0 1-.708 0L3 14.707l-.646.647a.5.5 0 0 1-.801-.13l-.5-1A.5.5 0 0 1 1 14V2a.5.5 0 0 1 .053-.224l.5-1a.5.5 0 0 1 .367-.27zm.217 1.338L2 2.118v11.764l.137.274.51-.51a.5.5 0 0 1 .707 0l.646.647.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.509.509.137-.274V2.118l-.137-.274-.51.51a.5.5 0 0 1-.707 0L12 1.707l-.646.647a.5.5 0 0 1-.708 0L10 1.707l-.646.647a.5.5 0 0 1-.708 0L8 1.707l-.646.647a.5.5 0 0 1-.708 0L6 1.707l-.646.647a.5.5 0 0 1-.708 0L4 1.707l-.646.647a.5.5 0 0 1-.708 0l-.509-.51z">
                        </path>
                        <path
                            d="M3 4.5a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5zm8-6a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5z">
                        </path>
                    </svg>
                    User Management
                </div>
            </h2>
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse flex-grow-1 text-right" id="navbarNav">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                    <a href="/invoice_table.html">
                        <button type="button" class="btn btn-outline-primary">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-house" viewBox="0 0 16 16">
              <path fill-rule="evenodd" d="M2 13.5V7h1v6.5a.5.5 0 0 0 .5.5h9a.5.5 0 0 0 .5-.5V7h1v6.5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 13.5zm11-11V6l-2-2V2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5z"></path>
              <path fill-rule="evenodd" d="M7.293 1.5a1 1 0 0 1 1.414 0l6.647 6.646a.5.5 0 0 1-.708.708L8 2.207 1.354 8.854a.5.5 0 1 1-.708-.708L7.293 1.5z"></path>
            </svg>
                            Invoice
                          </button>
                    </a>
                </li>
                &nbsp;&nbsp;&nbsp;
                <li class="nav-item">
                    
                </li>
                &nbsp;&nbsp;&nbsp;
                <li class="nav-item">
                    
                </li>
                &nbsp;&nbsp;&nbsp;
                <li class="nav-item">
                    
                </li>

            </ul>
            <ul class="navbar-nav">

                <li class="nav-item">
                    <a href="/index.html">
                        <button type="button" class="btn btn-outline-warning">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                class="bi bi-box-arrow-right" viewBox="0 0 16 16">
                                <path fill-rule="evenodd"
                                    d="M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0v2z">
                                </path>
                                <path fill-rule="evenodd"
                                    d="M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z">
                                </path>
                            </svg>
                            Logout
                        </button>
                    </a>
                </li>

            </ul>
        </div>
    </nav>
    <br>


    </div>

    <br />
    <table id="example" class="table table-striped table-bordered table-sm" cellspacing="0" width="100%">
        <thead>
            <tr>
                <th style="text-align:center;">ID
                </th>
                <th style="text-align:center;">UserName
                </th>
                <th style="text-align:center;">Email
                </th>
                <th style="text-align:center;">Password
                </th>
                <th style="text-align:center;">Role
                </th>
                <th style="text-align:center;">Active
                </th>

                <th style="text-align:center;">Actions
                </th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td id="userId" style="text-align:center;"></td>
                <td id="username" style="text-align:center;"></td>
                <td id="email" style="text-align:center;"></td>
                <td id="password" style="text-align:center;"></td>
                <td id="role" style="text-align:center;"></td>
                <td id="active" style="text-align:center;"></td>
                <td>
                    <div style="text-align:center;"> <button onclick="SendEmail(this)" type="button" class="get_email btn btn-outline-secondary">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-envelope-fill" viewBox="0 0 16 16">
          <path d="M.05 3.555A2 2 0 0 1 2 2h12a2 2 0 0 1 1.95 1.555L8 8.414.05 3.555zM0 4.697v7.104l5.803-3.558L0 4.697zM6.761 8.83l-6.57 4.027A2 2 0 0 0 2 14h12a2 2 0 0 0 1.808-1.144l-6.57-4.027L8 9.586l-1.239-.757zm3.436-.586L16 11.801V4.697l-5.803 3.546z"></path>
        </svg>
                      </button>
                        &nbsp;&nbsp;&nbsp;
                        <button onclick="DeleteUser(this)" type="button" class="update btn btn-outline-danger">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                class="bi bi-x-square" viewBox="0 0 16 16">
                                <path
                                    d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z">
                                </path>
                                <path
                                    d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z">
                                </path>
                            </svg>
                        </button>
                    </div>
                </td>
            </tr>
        </tbody>
        <tfoot>
            <tr>
                <th style="text-align:center;">ID
                </th>
                <th style="text-align:center;">UserName
                </th>
                <th style="text-align:center;">Email
                </th>
                <th style="text-align:center;">Password
                </th>
                <th style="text-align:center;">Role
                </th>
                <th style="text-align:center;">Active
                </th>

                <th style="text-align:center;">Actions
                </th>
            </tr>
        </tfoot>
    </table>

    </div>
    <script type="text/javascript">
        $(document).ready(function () {

            console.log("hehe");
            function setDataOnRow(rowObject, v) {
                var userId = v.userId;
                var username = v.username;
                var email = v.email;
                var password = v.password;
                var role = v.role;
                var active = v.active;
                $(rowObject).find("#userId").html(userId);
                $(rowObject).find("#username").html(username);
                $(rowObject).find("#email").html(email);
                $(rowObject).find("#password").html(password);
                $(rowObject).find("#role").html(role);
                $(rowObject).find("#active").html(active);
                $(rowObject).find(".update").val(userId);
                $(rowObject).find(".get_email").val(email);
            }
            $.ajax({
                url: "http://localhost:9191/users/all",
                method: "get",
                dataType: "json",
                success: function (data) {
                    console.log(data)
                    $('#example tbody').find("tr:gt(0)").remove(); //remove all old rows except first one
                    $.each(data, function (i, v) {
                        if (i == 0) {
                            //setting the data in first row itself
                            setDataOnRow($("#example tbody").find("tr").first(), v);
                            console.log(v)
                        } else {
                            //clonning the first row and setting data over it and then appending in tbody
                            var clonnedRow = $($("#example tbody").find("tr").first()).clone();
                            console.log(v)
                            setDataOnRow(clonnedRow, v);
                            $("#example tbody").append(clonnedRow);
                        }
                    })
                    $('#example').DataTable({
                        "bServerSide": false,
                    })
                }
            })

        }
        )
       

       

        

        function SendEmail(k) {
            console.log(k.value)
            localStorage.setItem("email", k.value)
            $.ajax({
               url: "http://localhost:9191/mail/send/" + localStorage.getItem("email"),
               method: "post",
                dataType: "json",
                    success: function (data) {
                    console.log("yatta")
                    }
            })
        }


        function DeleteUser(e) {
            console.log(e.value)
            localStorage.setItem("userId", e.value)
            var result = confirm("Are you sure that you want to DELETE this user?");
            if (result) {
                $.ajax({
                    url: "http://localhost:9191/users/delete/" + localStorage.getItem("userId"),
                    method: "delete",
                    dataType: "json",
                })
                alert("Delete Success!");
                window.location.reload();
            }
        }
    </script>


</body>